{% extends 'public/base_cpanel.html' %}
<!-- Cambiando el title -->
{% block title %}Crud - Python 🐍 | Lista de Libros{% endblock %}
<!---->
{% block body %}
<style>
    /* Estilos para hacer la tabla más responsive */
    .table-responsive {
        overflow-x: auto; /* Permite el scroll horizontal solo si es necesario */
        -webkit-overflow-scrolling: touch; /* Mejora el scroll en dispositivos táctiles */
        border-radius: 0.5rem; /* Bordes redondeados para el contenedor de la tabla */
        box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075); /* Sombra sutil */
    }

    .card.content_consignaciones {
        border-radius: 0.75rem !important; /* Bordes redondeados para el card principal */
        box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15) !important; /* Sombra más pronunciada para el card */
        padding: 1.5rem; /* Espaciado interno para el card */
    }

    .table {
        width: 100%; /* Asegura que la tabla ocupe el 100% del ancho de su contenedor */
        max-width: 100%; /* Evita que la tabla se desborde */
        margin-bottom: 0; /* Eliminar margen inferior de la tabla si el responsive container ya lo tiene */
        background-color: transparent;
        border-collapse: collapse; /* Colapsa los bordes de la tabla */
        border-spacing: 0; /* Elimina espacio entre celdas */
    }

    .table th,
    .table td {
        padding: 0.75rem;
        vertical-align: middle; /* Alinea verticalmente el contenido de la celda */
        border-top: 1px solid #e0e0e0; /* Color de borde más suave */
        white-space: normal; /* Permite que el texto se ajuste dentro de las celdas */
        word-wrap: break-word; /* Rompe palabras largas para que se ajusten */
    }

    .table thead th {
        vertical-align: bottom;
        border-bottom: 2px solid #bdbdbd; /* Borde más oscuro para el encabezado */
        font-weight: 600; /* Hace el texto del encabezado un poco más negrita */
        color: #424242; /* Color de texto para los encabezados */
        text-align: left; /* Alinea texto a la izquierda en los encabezados */
    }

    .table tbody + tbody {
        border-top: 2px solid #dee2e6;
    }

    /* Ajustes específicos para el ancho de las columnas */
    .table th:nth-child(1), .table td:nth-child(1) { /* Código */
        width: 8%; /* Más pequeño */
        max-width: 8%;
    }
    .table th:nth-child(2), .table td:nth-child(2) { /* Título */
        width: 25%; /* Un poco más de espacio */
        max-width: 25%;
    }
    .table th:nth-child(3), .table td:nth-child(3) { /* Autor/es */
        width: 20%;
        max-width: 20%;
    }
    .table th:nth-child(4), .table td:nth-child(4) { /* Ubicación */
        width: 15%;
        max-width: 15%;
    }
    .table th:nth-child(5), .table td:nth-child(5) { /* Categoría */
        width: 12%;
        max-width: 12%;
    }
    .table th:nth-child(6), .table td:nth-child(6) { /* Cantidad Disponible */
        width: 10%; /* Más pequeño, como solicitaste */
        max-width: 10%;
        text-align: center; /* Centrar la cantidad */
    }
    .table th:nth-child(7), .table td:nth-child(7) { /* Acciones */
        width: 10%; /* Ajustado para contener los botones */
        max-width: 10%;
        text-align: center; /* Centrar los botones de acción */
    }

    /* Estilos para las filas del cuerpo de la tabla */
    .table tbody tr {
        transition: background-color 0.2s ease; /* Suave transición al pasar el mouse */
    }

    .table tbody tr:hover {
        background-color: #f5f5f5; /* Color de fondo al pasar el mouse */
    }

    /* Ajustes para los botones de acción para que no ocupen tanto espacio */
    .table td a.btn {
        padding: 0.3rem 0.6rem; /* Ajuste del padding para un mejor aspecto */
        font-size: 0.8rem; /* Tamaño de fuente ligeramente más pequeño */
        line-height: 1.2; /* Ajuste del line-height */
        border-radius: 0.3rem; /* Bordes un poco más redondeados */
        margin: 2px; /* Espacio entre botones */
        display: inline-flex; /* Permite que el ícono y texto estén en línea con espacio */
        align-items: center; /* Alinea verticalmente ícono y texto */
        justify-content: center; /* Centra horizontalmente ícono y texto */
        min-width: 80px; /* Ancho mínimo para los botones para que no se vean demasiado pequeños */
    }

    .table td a.btn i {
        margin-right: 5px; /* Espacio entre el ícono y el texto */
    }

    /* Ocultar texto de los botones en pantallas pequeñas, dejando solo el ícono */
    @media (max-width: 768px) {
        .table td a.btn {
            padding: 0.2rem 0.4rem; /* Más pequeño en móvil */
            min-width: unset; /* Elimina el ancho mínimo en móvil */
        }
        .table td a.btn span {
            display: none; /* Oculta el texto */
        }
        .table td a.btn i {
            margin-right: 0 !important; /* Elimina el margen a la derecha del ícono */
        }
    }

    /* Estilos para la barra de búsqueda y botones de utilidad */
    .table-controls {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1rem;
        flex-wrap: wrap; /* Permite que los elementos se envuelvan en pantallas pequeñas */
        gap: 10px; /* Espacio entre elementos */
    }

    .table-controls .search-bar {
        display: flex;
        gap: 5px;
    }

    .table-controls .search-bar input {
        border: 1px solid #ced4da;
        border-radius: 0.25rem;
        padding: 0.375rem 0.75rem;
        flex-grow: 1; /* Permite que la barra de búsqueda crezca */
        min-width: 150px; /* Ancho mínimo para el input */
    }

    .table-controls .btn-utility {
        padding: 0.375rem 0.75rem;
        border-radius: 0.25rem;
        margin-right: 5px;
        background-color: #f8f9fa;
        border: 1px solid #ced4da;
        color: #343a40;
    }

    /* Estilos para paginación */
    .pagination-controls {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 1rem;
        flex-wrap: wrap;
        gap: 10px;
    }

    .pagination-info {
        font-size: 0.9rem;
        color: #6c757d;
    }

    .pagination {
        display: flex;
        padding-left: 0;
        list-style: none;
        border-radius: 0.25rem;
    }

    .page-item {
        margin: 0 2px;
    }

    .page-link {
        position: relative;
        display: block;
        padding: 0.375rem 0.75rem;
        margin-left: -1px;
        line-height: 1.25;
        color: #007bff;
        background-color: #fff;
        border: 1px solid #dee2e6;
        text-decoration: none;
        border-radius: 0.25rem; /* Bordes redondeados para los botones de paginación */
    }

    .page-item.active .page-link {
        z-index: 3;
        color: #fff;
        background-color: #007bff;
        border-color: #007bff;
    }

    .page-link:hover {
        color: #0056b3;
        background-color: #e9ecef;
        border-color: #dee2e6;
    }
</style>

<div class="card content_consignaciones">
    <section id="respuestaFiltroMes">
        <h2 class="text-center mt-5 mb-5">
            Lista de Libros
            <hr />
        </h2>

        {# Controles de búsqueda y utilidad #}
        <div class="table-controls">
            <div>
                <p class="btn btn-primary" style="margin-right: 10px;">
                    <a href="./register-libro">
                        <span style="color: white;">Nuevo Libro</span>
                    </a>
                </p>
                <button class="btn btn-utility">Copiar</button>
                <button class="btn btn-utility">Exportar Excel</button>
            </div>
            <div class="search-bar">
                <input type="text" placeholder="Buscar..." aria-label="Buscar libros">
                <button class="btn btn-secondary">Buscar</button>
            </div>
        </div>

        <div class="table-responsive">
            <table class="table table-hover">
                <thead>
                    <tr style="background-color: #ddd">
                        <th>Código</th>
                        <th>Título</th>
                        <th>Autor/es</th>
                        <th>Ubicación</th>
                        <th>Categoría</th>
                        <th>Cantidad Disponible</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    {% for libro in resp_librosBD %}
                    <tr>
                        <td>{{ libro.Codigo }}</td>
                        <td>{{ libro.Titulo }}</td>
                        <td>{{ libro.Autor_es }}</td>
                        <td>{{ libro.Ubicacion }}</td>
                        <td>{{ libro.Categoria }}</td>
                        <td>{{ libro.Cant_Disponibles }}</td>
                        <td>
                            <a
                                href="/editar-libro/{{ libro.Codigo }}"
                                class="btn btn-success btn-sm"
                                tooltip="Actualizar Registro">
                                <i class="bi bi-arrow-clockwise"></i> <span>Actualizar</span>
                            </a>
                            <a
                                style="color: white;"
                                onclick="eliminarLibro('{{ libro.Codigo }}', '{{ libro.Titulo }}');"
                                class="btn btn-danger btn-sm"
                                data-bs-toggle="tooltip"
                                data-bs-offset="0,4"
                                data-bs-placement="top"
                                data-bs-html="true"
                                title="<span>Eliminar a {{ libro.Titulo }}</span>">
                                <i class="bi bi-trash3"></i> <span>Eliminar</span>
                            </a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        {# Controles de paginación #}
        <div class="pagination-controls">
            <div class="pagination-info">
                Mostrando registros del 1 al {{ resp_librosBD|length }} de un total de {{ resp_librosBD|length }} registros {# Ajusta esto con la lógica de paginación real #}
            </div>
            <nav aria-label="Page navigation">
                <ul class="pagination">
                    <li class="page-item disabled">
                        <a class="page-link" href="#" aria-label="Anterior">
                            <span aria-hidden="true">&laquo;</span>
                        </a>
                    </li>
                    <li class="page-item active"><a class="page-link" href="#">1</a></li>
                    <li class="page-item">
                        <a class="page-link" href="#" aria-label="Siguiente">
                            <span aria-hidden="true">&raquo;</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </section>
</div>
{% endblock %}

<!--Script Custom-->
{% block customJS %}
<script>
    function eliminarLibro(id, tituloLibro) {
        const confirmation = confirm(`¿Estás seguro que deseas eliminar el libro ${tituloLibro}?`);

        if (confirmation) {
            let url = `/borrar-libro/${id}`;
            if (url) {
                window.location.href = url;
            }
        }
    }
</script>
{% endblock %}